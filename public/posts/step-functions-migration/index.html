<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step Functions State Machine Migration Guide | MzZavaa</title>
    <meta name="description" content="A comprehensive guide to migrating AWS Step Functions state machines between AWS accounts">
    
    
    <link rel="icon" href="/favicon.ico">
    
    
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    
    
    <link rel="stylesheet" href="/css/syntax.css">
    
    
    
    <link rel="stylesheet" href="/css/custom.css">
    
    <meta property="og:url" content="http://localhost:1313/posts/step-functions-migration/">
  <meta property="og:site_name" content="MzZavaa">
  <meta property="og:title" content="Step Functions State Machine Migration Guide">
  <meta property="og:description" content="A comprehensive guide to migrating AWS Step Functions state machines between AWS accounts">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-23T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-04-23T00:00:00+00:00">
    <meta property="article:tag" content="Aws">
    <meta property="article:tag" content="Step Functions">
    <meta property="article:tag" content="Migration">
    <meta property="article:tag" content="Serverless">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Step Functions State Machine Migration Guide">
  <meta name="twitter:description" content="A comprehensive guide to migrating AWS Step Functions state machines between AWS accounts">
      <meta name="twitter:site" content="@https://twitter.com/yourusername">

</head>
<body>
    <div class="site-container">
        <header class="site-header">
    <div class="container">
        <a href="http://localhost:1313/" class="logo">MzZavaa</a>
        
        <nav class="main-nav">
            <ul>
                
                <li><a href="/" class="">Home</a></li>
                
                <li><a href="/posts/" class="">Blog</a></li>
                
                <li><a href="/about/" class="">About</a></li>
                
                <li><a href="/tags/" class="">Tags</a></li>
                
            </ul>
        </nav>
        
        <div class="header-controls">
            <div class="theme-indicator">
                <span class="dark-label">Dark</span>
                <span class="light-label">Light</span>
            </div>
            <button id="theme-toggle" aria-label="Toggle dark/light mode">
                <i class="fas fa-sun"></i>
            </button>
        </div>
    </div>
</header>

        
        
        
        <section class="page-hero">
            <div class="container">
                <h1 class="gradient-text">Step Functions State Machine Migration Guide</h1>
                
                <p>A comprehensive guide to migrating AWS Step Functions state machines between AWS accounts</p>
                
            </div>
        </section>
        
        
        <main>
            



<div class="post-hero-banner">
    <img src="/images/52F86359-09F2-42AB-8372-ACDBCBBB22DD.png" alt="Step Functions State Machine Migration Guide">
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <div class="container">
            
            <div class="post-tags hero-tags">
                
                <a href="/tags/aws" class="post-tag hero-tag">aws</a>
                
                <a href="/tags/step-functions" class="post-tag hero-tag">step functions</a>
                
                <a href="/tags/migration" class="post-tag hero-tag">migration</a>
                
                <a href="/tags/serverless" class="post-tag hero-tag">serverless</a>
                
            </div>
            
        </div>
    </div>
</div>




<article class="single-post">
    <div class="container">
        
        <div class="post-navigation top-navigation">
    
    
    
    <div class="next-post">
        <a href="http://localhost:1313/posts/markdown-syntax-guide/">
            <span>Older Post</span>
            <h3>Markdown Syntax Guide</h3>
            <i class="fas fa-arrow-right"></i>
        </a>
    </div>
    
</div>


        
        <div class="post-content">
    
    
    <div class="post-meta">
    <span class="post-date">
        <i class="far fa-calendar"></i> Apr 23, 2025
    </span>
    
    <span class="post-reading-time">
        <i class="far fa-clock"></i> 3 min read
    </span>
    
    
    <span class="post-author">
        <i class="far fa-user"></i> Linda Mohamed
    </span>
    
</div>

    
    
    
    <img src="/images/52F86359-09F2-42AB-8372-ACDBCBBB22DD.png" alt="Step Functions State Machine Migration Guide" class="first-paragraph-image">
    
    
    
    
    <h1 id="step-functions-state-machine-migration-guide">Step Functions State Machine Migration Guide</h1>
<p>This guide explains how to migrate a Step Functions state machine from one AWS account to another.</p>
<p><img src="/images/52F86359-09F2-42AB-8372-ACDBCBBB22DD.png" alt="AWS Architecture Diagram"></p>
<h2 id="overview">Overview</h2>
<p>AWS Step Functions is a serverless workflow service that lets you coordinate multiple AWS services into business-critical applications. When migrating between AWS accounts, you need to carefully handle the state machine definition and all associated resources.</p>
<h2 id="migration-steps">Migration Steps</h2>
<h3 id="1-in-the-source-account">1. In the Source Account</h3>
<p>First, you need to extract all the necessary information from your source account:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Extract the state machine definition</span>
</span></span><span style="display:flex;"><span>aws stepfunctions describe-state-machine <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --state-machine-arn arn:aws:states:&lt;REGION&gt;:&lt;SOURCE_ACCOUNT_ID&gt;:stateMachine:Video-processing-workflow <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --output json &gt; video-processing-workflow-definition.json
</span></span></code></pre></div><p>Make sure to note all IAM roles and resources used by the state machine:</p>
<ul>
<li>IAM role for Step Functions execution</li>
<li>IAM role for MediaConvert (<code>MyMediaConvertServiceRole</code>)</li>
<li>Lambda function (<code>generateSummaryAndBlogPost</code>)</li>
<li>S3 bucket for video processing</li>
<li>CloudWatch Logs group for logging</li>
</ul>
<h3 id="2-in-the-target-account">2. In the Target Account</h3>
<h4 id="create-required-resources">Create Required Resources</h4>
<p>Before creating the state machine in the target account, you need to create all the required resources:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Create IAM roles</span>
</span></span><span style="display:flex;"><span>aws iam create-role <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --role-name StepFunctions-Video-processing-workflow-role <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --assume-role-policy-document file://step-functions-trust-policy.json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>aws iam create-role <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --role-name MyMediaConvertServiceRole <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --assume-role-policy-document file://mediaconvert-trust-policy.json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Attach necessary policies to the roles</span>
</span></span><span style="display:flex;"><span>aws iam attach-role-policy <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --role-name StepFunctions-Video-processing-workflow-role <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --policy-arn arn:aws:iam::aws:policy/service-role/AWSStepFunctionsFullAccess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>aws iam attach-role-policy <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --role-name MyMediaConvertServiceRole <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess
</span></span></code></pre></div><h4 id="update-state-machine-definition">Update State Machine Definition</h4>
<p>You need to update all ARNs in the definition file to use the target account ID:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Load the state machine definition</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;video-processing-workflow-definition.json&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    state_machine <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>load(f)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>definition <span style="color:#f92672">=</span> state_machine[<span style="color:#e6db74">&#39;definition&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Replace source account ID with target account ID</span>
</span></span><span style="display:flex;"><span>source_account_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;SOURCE_ACCOUNT_ID&gt;&#39;</span>
</span></span><span style="display:flex;"><span>target_account_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;TARGET_ACCOUNT_ID&gt;&#39;</span>
</span></span><span style="display:flex;"><span>updated_definition <span style="color:#f92672">=</span> definition<span style="color:#f92672">.</span>replace(source_account_id, target_account_id)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Save the updated definition</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;updated-definition.json&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(updated_definition)
</span></span></code></pre></div><h4 id="create-the-state-machine">Create the State Machine</h4>
<p>Finally, create the state machine in the target account:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>aws stepfunctions create-state-machine <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --name <span style="color:#e6db74">&#34;Video-processing-workflow&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --definition file://updated-definition.json <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --role-arn <span style="color:#e6db74">&#34;arn:aws:iam::&lt;TARGET_ACCOUNT_ID&gt;:role/service-role/StepFunctions-Video-processing-workflow-role&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --type STANDARD <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --logging-configuration <span style="color:#e6db74">&#39;{&#34;level&#34;: &#34;ALL&#34;, &#34;includeExecutionData&#34;: true, &#34;destinations&#34;: [{&#34;cloudWatchLogsLogGroup&#34;: {&#34;logGroupArn&#34;: &#34;arn:aws:logs:&lt;REGION&gt;:&lt;TARGET_ACCOUNT_ID&gt;:log-group:/aws/vendedlogs/states/Video-processing-workflow-Logs:*&#34;}}]}&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --region &lt;TARGET_REGION&gt;
</span></span></code></pre></div><h2 id="using-aws-console">Using AWS Console</h2>
<p>If you prefer using the AWS Console:</p>
<ol>
<li>Open the Step Functions console in the target account</li>
<li>Click &ldquo;Create state machine&rdquo;</li>
<li>Choose &ldquo;Author with code snippets&rdquo;</li>
<li>Paste the updated definition</li>
<li>Configure the execution role and other settings</li>
<li>Create the state machine</li>
</ol>
<h2 id="verifying-the-migration">Verifying the Migration</h2>
<p>After creating the state machine in the target account, you should:</p>
<ol>
<li>Verify that all resources are correctly referenced</li>
<li>Run a test execution to ensure everything works as expected</li>
<li>Check CloudWatch Logs for any errors</li>
</ol>
<h2 id="common-issues-and-solutions">Common Issues and Solutions</h2>
<h3 id="iam-permission-issues">IAM Permission Issues</h3>
<p>If you encounter permission errors, check that:</p>
<ul>
<li>The Step Functions execution role has permissions to invoke all services used in the workflow</li>
<li>All service-specific roles (like MediaConvert) have the necessary permissions</li>
</ul>
<h3 id="resource-not-found-errors">Resource Not Found Errors</h3>
<p>If resources can&rsquo;t be found:</p>
<ul>
<li>Verify that all ARNs in the state machine definition have been updated to the target account</li>
<li>Ensure all referenced resources (Lambda functions, S3 buckets) exist in the target account</li>
</ul>
<h3 id="region-specific-issues">Region-Specific Issues</h3>
<p>If you&rsquo;re also changing regions:</p>
<ul>
<li>Update all region references in the state machine definition</li>
<li>Be aware of region-specific service endpoints</li>
<li>Check for region-specific service limitations</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Migrating Step Functions state machines between AWS accounts requires careful planning and execution. By following this guide, you should be able to successfully migrate your workflows while minimizing downtime and errors.</p>
<p>Remember to test thoroughly in the target account before decommissioning resources in the source account.</p>

</div>

        
        
        <div class="post-navigation bottom-navigation">
    
    
    
    <div class="next-post">
        <a href="http://localhost:1313/posts/markdown-syntax-guide/">
            <span>Older Post</span>
            <h3>Markdown Syntax Guide</h3>
            <i class="fas fa-arrow-right"></i>
        </a>
    </div>
    
</div>

    </div>
</article>

        </main>
        
        <footer class="site-footer">
    <div class="container">
        <div class="footer-content">
            <div class="copyright">
                &copy; 2025 MzZavaa. All rights reserved.
            </div>
            
            <div class="social-links">
                
                <a href="https://github.com/yourusername" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
                    <i class="fab fa-github"></i>
                </a>
                
                
                
                <a href="https://twitter.com/yourusername" target="_blank" rel="noopener noreferrer" aria-label="Twitter">
                    <i class="fab fa-twitter"></i>
                </a>
                
                
                
                <a href="https://linkedin.com/in/yourusername" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
                    <i class="fab fa-linkedin"></i>
                </a>
                
            </div>
        </div>
    </div>
</footer>

    </div>
    
    
    <script src="/js/main.js"></script>
    
</body>
</html>
